/*!
 * Chat Components for PurrAI
 */

@layer components {
    /* Message Timestamp */
    .message-timestamp {
        @apply text-xs mt-1 font-medium;
        @apply text-slate-400/70;
    }

    .message-timestamp:hover {
        @apply text-slate-400;
    }

    .dark .message-timestamp {
        @apply text-slate-600;
    }

    .dark .message-timestamp:hover {
        @apply text-slate-500;
    }

    /* Welcome Screen */
    .welcome-container {
        @apply flex flex-col items-center justify-center h-full text-center px-4;
    }

    .welcome-logo {
        @apply w-38! h-38! mb-4;
    }

    .animate-welcome-logo {
        animation: var(--animate-welcome-logo);
        animation-fill-mode: both;
    }

    .welcome-title {
        @apply text-2xl font-semibold mb-2 text-slate-900;
    }

    .dark .welcome-title {
        @apply text-slate-50;
    }

    .welcome-message {
        @apply max-w-md text-slate-500 dark:text-slate-600;
    }

    .chat-messages {
        @apply flex-1 overflow-y-auto p-6 md:p-10 space-y-8 pb-44!;
        scroll-behavior: smooth;
    }

    /* Input Dock Wrapper */
    .input-dock-wrapper {
        @apply absolute bottom-6 left-1/2 -translate-x-1/2 w-[calc(100%-3rem)] max-w-3xl z-10;
        @apply flex flex-col gap-2;
    }

    /* Model Selector */
    .model-selector-container {
        @apply flex justify-center;
    }

    .model-selector {
        @apply relative;
    }

    .model-selector-footer {
        @apply text-sm text-center bg-transparent flex justify-between items-center text-slate-600 px-3;
    }

    .dark .model-selector-footer {
        @apply text-slate-300;
    }

    .model-selector-trigger {
        @apply flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-medium;
        @apply transition-all cursor-pointer border;
        backdrop-filter: blur(var(--window-blur));
        @apply bg-slate-50/80 border-slate-200/80 text-slate-700;
    }

    .model-selector-trigger:hover {
        @apply bg-slate-50/95 border-slate-300;
    }

    .dark .model-selector-trigger {
        @apply bg-slate-800/80 border-slate-700/60 text-slate-200;
    }

    .dark .model-selector-trigger:hover {
        @apply bg-slate-800/95 border-slate-600;
    }

    .model-selector-value {
        @apply max-w-32 truncate;
    }

    .model-selector-dropdown {
        @apply absolute bottom-full left-1/2 -translate-x-1/2 mb-2 min-w-48 max-w-64 select-none;
    }

    .model-selector-group {
        @apply py-1;
    }

    .model-selector-group:not(:last-child) {
        @apply border-b;
        @apply border-slate-200/50;
    }

    .dark .model-selector-group:not(:last-child) {
        @apply border-slate-700/50;
    }

    .model-selector-group-label {
        @apply px-3 py-1.5 text-[10px] font-semibold uppercase tracking-wider;
        @apply text-slate-500;
        @apply sticky top-0 z-10;
    }

    .model-selector-group-label span {
        @apply bg-white/85 dark:bg-slate-800/85 rounded-full px-2 py-1;
    }

    .dark .model-selector-group-label {
        @apply text-slate-400;
    }

    .model-selector-option {
        @apply w-full flex items-center justify-between gap-2 px-3 pl-5 py-2 text-xs;
        @apply transition-colors cursor-pointer text-left text-slate-700;
    }

    .model-selector-option:hover {
        @apply bg-slate-100;
    }

    .model-selector-option.active {
        @apply bg-slate-100 text-slate-900 font-medium;
    }

    .dark .model-selector-option {
        @apply text-slate-200;
    }

    .dark .model-selector-option:hover {
        @apply bg-slate-700/50;
    }

    .dark .model-selector-option.active {
        @apply bg-slate-700/50 text-slate-50;
    }

    .model-selector-empty {
        @apply flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-medium;
        @apply transition-all cursor-pointer border;
        @apply bg-amber-100/80 border-amber-300/50 text-amber-800;
        backdrop-filter: blur(var(--window-blur));
    }

    .model-selector-empty:hover {
        @apply bg-amber-100/95 border-amber-300;
    }

    .dark .model-selector-empty {
        @apply bg-amber-900/20 border-amber-900/30 text-amber-300;
    }

    .dark .model-selector-empty:hover {
        @apply bg-amber-900/30 border-amber-900/50;
    }

    /* Chat Rows */
    .chat-row {
        @apply flex gap-2 w-full animate-slide-up;
        max-width: min(48rem, 100%);
        min-width: 0;
    }

    .chat-row.user {
        @apply ml-auto justify-end;
    }

    /* Chat Bubbles */
    .chat-bubble {
        @apply px-5 py-3 text-[15px] leading-relaxed shadow-sm relative;
        max-width: 100%;
        word-wrap: break-word;
        overflow-wrap: break-word;
        min-width: 0;
    }

    .chat-bubble .see-more-less-btn {
        @apply text-sm opacity-70 hover:opacity-100 ml-1 cursor-pointer inline-flex items-center gap-1 select-none;
    }

    .chat-bubble.primary {
        @apply rounded-[20px]! rounded-tr-[4px]! ml-auto;
    }

    .chat-bubble.primary,
    .chat-bubble.secondary {
        @apply rounded-[20px] rounded-tl-[4px] border;
        @apply bg-slate-100 border-slate-200 text-slate-900;
        backdrop-filter: blur(var(--window-blur));
    }

    .dark .chat-bubble.primary,
    .dark .chat-bubble.secondary {
        @apply bg-slate-800/90 border-slate-700/60 text-slate-100;
    }

    /* Prose styles for markdown content */
    .chat-bubble.primary.prose,
    .chat-bubble.secondary.prose {
        @apply prose-headings:mt-4 prose-headings:mb-2 prose-headings:font-semibold;
        @apply prose-p:my-2 prose-p:leading-relaxed;
        @apply prose-ul:my-2 prose-ul:pl-4 prose-ol:my-2 prose-ol:pl-4;
        @apply prose-li:my-0.5;
        @apply prose-pre:my-3 prose-pre:p-3 prose-pre:rounded-xl;
        @apply prose-a:underline prose-a:underline-offset-2;
        @apply prose-blockquote:border-l-4 prose-blockquote:pl-4 prose-blockquote:italic prose-blockquote:my-3;
    }

    /* Inline code (not in pre blocks) */
    .chat-bubble.prose code:not(pre code) {
        @apply bg-slate-200 text-slate-700;
    }

    .dark .chat-bubble.prose code:not(pre code) {
        @apply bg-slate-700 text-slate-100;
    }

    /* Pre blocks - consolidated styles with !important to override Tailwind */
    .chat-bubble.prose pre {
        font-size: 14px !important;
        width: 100% !important;
        max-width: 100% !important;
        overflow: auto !important;
        white-space: pre !important;
        word-break: normal !important;
        word-wrap: normal !important;
        scrollbar-width: thin;
        scrollbar-color: rgb(71 85 105) rgb(15 23 42);
        border-radius: 0.75rem !important;
        display: block !important;
        margin: 0 !important;
        padding: 1rem !important;
    }

    /* Ensure code inside pre doesn't affect the width */
    .chat-bubble.prose pre code {
        display: block !important;
        white-space: pre-wrap !important;
        word-break: normal !important;
        word-wrap: normal !important;
        overflow: visible !important;
        width: 100% !important;
        max-width: 100% !important;
        padding-top: 1rem !important;
    }

    /* Custom scrollbar for pre blocks */
    .chat-bubble.prose pre::-webkit-scrollbar {
        width: 8px;
        height: 8px;
    }

    .chat-bubble.prose pre::-webkit-scrollbar-track {
        @apply bg-slate-950 rounded;
    }

    .chat-bubble.prose pre::-webkit-scrollbar-thumb {
        @apply bg-slate-600 rounded;
    }

    .chat-bubble.prose pre::-webkit-scrollbar-thumb:hover {
        @apply bg-slate-500;
    }

    /* Copy button for code blocks */
    .code-copy-btn {
        @apply absolute top-2 right-2 p-1.5 rounded-md;
        @apply bg-slate-100/10 hover:bg-slate-100/20 transition-colors;
        @apply text-slate-100/70 hover:text-slate-100;
        @apply cursor-pointer opacity-0;
        @apply flex items-center justify-center;
    }

    pre:hover .code-copy-btn {
        @apply opacity-100;
    }

    .code-copy-btn.copied {
        @apply bg-emerald-500/20 text-emerald-400;
    }

    .chat-bubble.secondary.prose a {
        color: rgb(37 99 235);
    }

    .dark .chat-bubble.secondary.prose a {
        color: rgb(96 165 250);
    }

    .chat-bubble.secondary.prose blockquote {
        @apply border-slate-300 text-slate-600;
    }

    .dark .chat-bubble.secondary.prose blockquote {
        @apply border-slate-600 text-slate-400;
    }

    /* Avatar */
    .purr-ai-logo {
        @apply w-8 h-8;
        @apply flex items-center justify-center shrink-0 select-none;
    }

    .user-avatar {
        @apply w-8 h-8 rounded-full bg-linear-to-tr from-slate-200 to-slate-400 dark:from-slate-700 dark:to-slate-500;
        @apply flex items-center justify-center shadow-inner shrink-0 select-none sticky top-2;
        @apply transition-all duration-200 hover:scale-110 hover:shadow-md dark:hover:shadow-slate-600/20;
    }

    /* Tool Calling Message */
    .tool-calling {
        @apply inline-block text-sm italic;
        @apply opacity-80;
        @apply text-slate-600;
        @apply transition-opacity duration-300;
    }

    .dark .tool-calling {
        @apply text-slate-400;
    }

    /* Hidden state for completed tool calls */
    .tool-calling.completed {
        @apply hidden;
    }
}
